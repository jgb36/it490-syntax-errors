<html>
<script>
HandleValidation()
function HandleValidation()
{
        var session = new XMLHttpRequest();
        session.open("POST","login.php",true);
        session.setRequestHeader("Content-Type","application/x-www-form-urlencoded");
        session.onreadystatechange= function ()
        {
                if ((this.readyState == 4)&&(this.status == 200))
                {
                        var t = JSON.stringify(this.responseText);
                        document.getElementById("textResponse").innerHTML = "response: "+t+"<p>";
                        const o = JSON.parse(this.responseText);
                        if(o.Validated == false)
                        {
                                SendLogoutRequest();
                        }

                }
        }
        session.send("type=validate_session");
}

function SendLogoutRequest()
{
        event.preventDefault();
        //var username = document.getElementById('username').value;
        var request = new XMLHttpRequest();
        request.open("POST","login.php",true);
        request.setRequestHeader("Content-Type","application/x-www-form-urlencoded");
        //request.send("type=logout");
	request.onreadystatechange= function ()
        {
                if ((this.readyState == 4)&&(this.status == 200))
                {
			//request.send("type=logout");
			window.location = "index.html";

                }
        }
	request.send("type=logout");

}
</script>
<h1>Home Page</h1>
<body>
<div id="textResponse">
<p>You have successfully logged in</p>
</div>
<p>Click here to <a href = "index.html"> login </a>
<p>Click here to <a href = "register.html"> register </a>

<script>
//SendLoginRequest("kehoed","12345");
</script>
<form method = "post">
	<input name="logout" type="submit" value="Logout" onclick = SendLogoutRequest() />
</form>

</body>
</html>
